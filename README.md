# NOAA_Fish_Detection
All codes are here: https://microsoft-my.sharepoint.com/:f:/p/antriv/EvhEqYagibZHkx4oe1x7YIgBlu907QDHgSre6E4xaL-uew?e=yYTieS

Please download and extract the zip files.


# Prerequisites
Python: 3.5, CUDA: 10.0, CUDNN:7 

download the "req.txt" file here

If running for multiple videos, make sure they are all in one directory

# Files Needed
- noaa_imerit_1_main_inference_single_videoUse.py
  - Used to detect fish for one video
- noaa_imerit_2_main_inference_multiple_videoUse.py
  - Used to detect fish for multiple videos in one directory 
- noaa_imerit_OD_inference_mainUse.py
  - Used to generate a csv of frame numbers(ie timestamps) for when fish are detected for a single video
- noaa_imerit_main_inference_single_video.py
  - Used to detect fish for one video(*SHOULD NOT BE RUN IN TERMINAL*)
- noaa_imerit_framesUse.py
  - Used to generate a folder with images generated by both v1 and v2 models for a single video
  
# Set Up

1. conda create -n noaa_env python=3.5 anaconda 

2. conda activate noaa_env

3. pip install â€“r req.txt 

4. Run the following command on terminal:
   export PYTHONPATH=$PYTHONPATH:<user_path>/models/research:<user_path>/models/research/slim
   
# Fish Detection for GUI Single Video:

1. Install "X"-Server locally (e.g: XMing Server)

2. Activate "-X" option when connecting to VM

3. Run the following command on terminal:
   python <dir_path>/models/research/object_detection/noaa_imerit_OD_inference.py 

# Fish Detection for Single Video (terminal):

1. mkdir <dir_path>/Project_NOAA_imerit/outimg

2. mkdir <dir_path>/Project_NOAA_imerit/outimg/csvfiles 

3. python <dir_path>/models/research/object_detection/noaa_imerit_1_main_inference_single_videoUse.py 

   --pathVideo <dir_path>/Project_NOAA_imerit/data/test/videos/2019_GOPR1207_analyze.MP4 
   
   --pathCSV <dir_path>/Project_NOAA_imerit/outimg/csvfiles/ 
   
   --pathIMG <dir_path>/Project_NOAA_imerit/outimg/ 

# Fish Detection for Multiple Video(terminal):

1. mkdir <dir_path>/Project_NOAA_imerit/outimg 

2. mkdir <dir_path>/Project_NOAA_imerit/outimg/csvfiles 

3. python <dir_path>/noaa_imerit_2_main_inference_multiple_videoUse.py 

    --pathVideo <dir_path>/Project_NOAA_imerit/data/test/videos/ 
    
    --pathCSV <dir_path>/Project_NOAA_imerit/outimg/csvfiles/ 
    
    --pathIMG <dir_path>/Project_NOAA_imerit/outimg/ 

# Output Expected

- One CSV file for each video file in the CSV directory
  - Each csv file has the naming convention: <video name>_<model name (v1 or v2)>.csv
  - Each csv lists the frame numbers(i.e. timestamps) at which the fish were detected
- One IMAGE folder for each video in the IMAGE directory 
  - Each image folder has the naming convention:<video name>_<model name (v1 or v2)>
  - Each image within each folder has the naming convention:<video name>_<model name (v1 or v2)>_<frame number>.jpg
  - Inside IMAGE folder will be images generated by both v1 and v2 models for a single video
